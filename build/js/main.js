!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=jQuery},function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._events={}}var e,n,o;return e=t,(n=[{key:"on",value:function(t,e){return(this._events[t]||(this._events[t]=[])).push(e),this}},{key:"emit",value:function(t,e){(this._events[t]||[]).slice().forEach(function(t){return t(e)})}}])&&i(e.prototype,n),o&&i(e,o),t}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=c(this,d(e).call(this))).model=t,o.view=n,o.view.btnLoadMore.addEventListener("click",function(t){o.actionLoadMore()}),o.view.btnAddNew.addEventListener("click",function(t){o.modalNewTask()}),o.view.btnSave.addEventListener("click",function(t){o.actionSave(t)}),o.view.btnShowAll.addEventListener("click",function(t){o.actionFilter("all")}),o.view.btnShowComleted.addEventListener("click",function(t){o.actionFilter("completed")}),o.view.btnshowNotCompled.addEventListener("click",function(t){o.actionFilter("notCompleted")}),n.on("completed",function(t){return o.actionComplited(t)}),n.on("delete",function(t){return o.actionDelete(t)}),n.on("show",function(t){return o.actionShowTask(t)}),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,r),n=e,(o=[{key:"actionComplited",value:function(t){this.model.setComplited(t.getAttribute("data-index")),this.view.rebuildTable()}},{key:"actionDelete",value:function(t){this.model.deleteTask(t.getAttribute("data-index")),this.view.rebuildTable()}},{key:"actionShowTask",value:function(t){var e=this.model.findTaskById(t.getAttribute("data-index"));this.view.btnSave.setAttribute("action","update"),document.getElementById("myModal").setAttribute("data-index",e.data.id),document.getElementById("modal-title").textContent="TaskID: "+e.data.id,document.getElementById("title-todo").value=e.data.title,document.getElementById("textToDo").value=e.data.fullText,a()("#myModal").modal("show")}},{key:"actionLoadMore",value:function(){this.view.rebuildTable()}},{key:"actionFilter",value:function(t){this.model.filterTask(t),this.view.rebuildTable()}},{key:"getData",value:function(){fetch("https://jsonplaceholder.typicode.com/todos").then(function(t){return t.json()}).then(function(t){return window.localStorage.setItem("testDB",JSON.stringify(t))}).catch(function(){console.log("error")})}},{key:"modalNewTask",value:function(){document.getElementById("myModal").setAttribute("data-index",""),document.getElementById("modal-title").textContent="ADD new task",document.getElementById("title-todo").value="",document.getElementById("textToDo").value="",this.view.btnSave.setAttribute("action","saveNew"),a()("#myModal").modal("show")}},{key:"actionSave",value:function(t){var e=document.getElementById("title-todo"),n=document.getElementById("textToDo");if("saveNew"===t.currentTarget.getAttribute("action")&&this.model.toStorage(this.model.activeUser,e.value,n.value),"update"===t.currentTarget.getAttribute("action")){var o=document.getElementById("myModal").getAttribute("data-index");this.model.updateTask(o,e.value,n.value)}document.getElementById("myModal").setAttribute("data-index",""),e.value="",n.value="",a()("#myModal").modal("hide"),this.view.rebuildTable()}},{key:"setView",value:function(){0===this.model.taskList.length?this.view.showMsg("no tasks yet"):this.view.showTaskList(this.model.taskList,3)}}])&&s(n.prototype,o),i&&s(n,i),e}();function m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.taskList=JSON.parse(window.localStorage.getItem("data"))||[],this.lastId=JSON.parse(window.localStorage.getItem("lastID"))||1,this.loadStep=JSON.parse(window.localStorage.getItem("loadStep"))||0,this.taskFilter=JSON.parse(window.localStorage.getItem("taskFilter"))||"all",this.activeUser=1}var e,n,o;return e=t,(n=[{key:"toStorage",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.taskList.push({id:this.lastId,userId:t,title:e,fullText:n,completed:o}),this.lastId++,this.setLastID(this.lastId),window.localStorage.setItem("data",JSON.stringify(this.taskList))}},{key:"findTaskById",value:function(t){for(var e=0;e<this.taskList.length;e++)if(this.taskList[e].id==t)return{index:e,data:this.taskList[e]}}},{key:"filterTask",value:function(t){this.taskFilter=t,window.localStorage.setItem("taskFilter",JSON.stringify(this.taskFilter))}},{key:"setComplited",value:function(t){var e=this.findTaskById(t);e.data.completed=!e.data.completed,this.taskList[e.index]=e.data,this.updateStorage()}},{key:"updateTask",value:function(t,e,n){var o=this.findTaskById(t);o.data.title=e,o.data.fullText=n,this.taskList[o.index]=o.data,this.updateStorage()}},{key:"deleteTask",value:function(t){var e=this.findTaskById(t);this.taskList.splice(e.index,1),this.updateStorage()}},{key:"updateStorage",value:function(){window.localStorage.setItem("data",JSON.stringify(this.taskList))}},{key:"setLastID",value:function(t){window.localStorage.setItem("lastID",JSON.stringify(t))}},{key:"getAutor",value:function(){return"Admin"}},{key:"loadMore",value:function(){console.log("step"+this.loadStep);var t=JSON.parse(window.localStorage.getItem("testDB"));this.loadStep,t.length;for(var e=this.loadStep;e<t.length;e++){if(t.length,this.loadStep+5==e){this.loadStep+=5,window.localStorage.setItem("loadStep",JSON.stringify(this.loadStep));break}this.toStorage(t[e].userId,t[e].title," ",t[e].completed)}}}])&&m(e.prototype,n),o&&m(e,o),t}();function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=v(this,y(e).call(this))).model=t,o.wraper=n.wraper,o.btnAddNew=n.btnAddNew,o.btnSave=n.btnSave,o.btnLoadMore=n.btnLoadMore,o.btnShowAll=n.btnShowAll,o.btnShowComleted=n.btnShowComleted,o.btnshowNotCompled=n.btnshowNotCompled,o}var n,o,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(e,r),n=e,(o=[{key:"rebuildTable",value:function(){if(this.wraper.innerHTML=" ",this.filterBtnClassToggle(),0===this.model.taskList.length)this.showMsg("no tasks yet");else{var t=document.querySelector(".text-msg");t&&t.remove(),this.showTaskList(this.model.taskList,3)}}},{key:"showTaskList",value:function(t){for(var e=0;e<t.length;e++)switch(this.model.taskFilter){case"completed":t[e].completed&&this.createTableRow(t,e);break;case"notCompleted":t[e].completed||this.createTableRow(t,e);break;case"all":this.createTableRow(t,e)}}},{key:"filterBtnClassToggle",value:function(){switch(this.btnShowAll.classList.remove("active"),this.btnShowComleted.classList.remove("active"),this.btnshowNotCompled.classList.remove("active"),this.model.taskFilter){case"completed":this.btnShowComleted.classList.add("active");break;case"notCompleted":this.btnshowNotCompled.classList.add("active");break;case"all":this.btnShowAll.classList.add("active")}}},{key:"createTableRow",value:function(t,e){var n=document.createElement("tr");t[e].completed&&n.classList.add("table-success");var o=document.createElement("td");o.innerHTML=e+1,n.appendChild(o);var a=document.createElement("td");a.innerHTML=this.model.getAutor(t[e].userId),n.appendChild(a);var i=document.createElement("td");i.innerHTML=t[e].title,n.appendChild(i);var r=document.createElement("td");this.createActionBar(r,t[e].id,t[e].completed),n.appendChild(r),this.wraper.appendChild(n)}},{key:"showMsg",value:function(t){var e=document.createElement("div");e.classList.add("text-msg"),e.textContent=t,document.querySelector(".main").prepend(e)}},{key:"createActionBar",value:function(t,e,n){var o=this,a=0;switch(n){case!0:a='<i class="fas fa-check-square"></i>';break;default:a='<i class="far fa-square"></i>'}var i=document.createElement("button");i.classList.add("btn"),i.classList.add("btn-outline-success"),i.setAttribute("data-index",e),i.innerHTML=a,i.addEventListener("click",function(t){return o.emit("completed",t.currentTarget)}),t.appendChild(i);var r=document.createElement("button");r.classList.add("btn"),r.classList.add("btn-outline-primary"),r.setAttribute("data-index",e),r.innerHTML='<i class="fas fa-edit"></i>',r.addEventListener("click",function(t){return o.emit("show",t.currentTarget)}),t.appendChild(r);var l=document.createElement("button");l.classList.add("btn"),l.classList.add("btn-outline-danger"),l.setAttribute("data-index",e),l.innerHTML='<i class="fas fa-trash-alt"></i>',l.addEventListener("click",function(t){return o.emit("delete",t.currentTarget)}),t.appendChild(l)}}])&&b(n.prototype,o),a&&b(n,a),e}(),k=new h,S=new g(k,{wraper:document.getElementById("task-list"),btnAddNew:document.getElementById("createNew"),btnSave:document.getElementById("save"),btnLoadMore:document.getElementById("load-more"),btnShowAll:document.getElementById("showAll"),btnShowComleted:document.getElementById("showComleted"),btnshowNotCompled:document.getElementById("showNotCompled")});new f(k,S);S.rebuildTable(),S.filterBtnClassToggle()}]);