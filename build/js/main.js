!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=jQuery},function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o);function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._events={}}var e,n,o;return e=t,(n=[{key:"on",value:function(t,e){return(this._events[t]||(this._events[t]=[])).push(e),this}},{key:"emit",value:function(t,e){(this._events[t]||[]).slice().forEach(function(t){return t(e)})}}])&&i(e.prototype,n),o&&i(e,o),t}();function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.taskList=JSON.parse(window.localStorage.getItem("data"))||[],this.lastId=JSON.parse(window.localStorage.getItem("lastID"))||1,this.loadStep=JSON.parse(window.localStorage.getItem("loadStep"))||0,this.taskFilter=JSON.parse(window.localStorage.getItem("taskFilter"))||"all",this.oderTask=JSON.parse(window.localStorage.getItem("oderTask"))||"up",this.activeUser=11}var e,n,o;return e=t,(n=[{key:"toStorage",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.taskList.push({id:this.lastId,userId:t,title:e,fullText:n,completed:o}),this.lastId++,this.setLastID(this.lastId),window.localStorage.setItem("data",JSON.stringify(this.taskList))}},{key:"findTaskById",value:function(t){for(var e=0;e<this.taskList.length;e++)if(this.taskList[e].id==t)return{index:e,data:this.taskList[e]}}},{key:"filterTask",value:function(t){this.taskFilter=t,window.localStorage.setItem("taskFilter",JSON.stringify(this.taskFilter))}},{key:"OrderDirection",value:function(){"up"===this.oderTask?this.oderTask="down":this.oderTask="up",window.localStorage.setItem("oderTask",JSON.stringify(this.oderTask))}},{key:"setComplited",value:function(t){var e=this.findTaskById(t);e.data.completed=!e.data.completed,this.taskList[e.index]=e.data,this.updateStorage()}},{key:"updateTask",value:function(t,e,n){var o=this.findTaskById(t);o.data.title=e,o.data.fullText=n,this.taskList[o.index]=o.data,this.updateStorage()}},{key:"deleteTask",value:function(t){var e=this.findTaskById(t);this.taskList.splice(e.index,1),this.updateStorage()}},{key:"updateStorage",value:function(){window.localStorage.setItem("data",JSON.stringify(this.taskList))}},{key:"setLastID",value:function(t){window.localStorage.setItem("lastID",JSON.stringify(t))}},{key:"getAutor",value:function(t){var e={1:"James",2:"Robert",3:"Michael",4:"William",5:"Linda",6:"Thomas",7:"Nancy",8:"Lisa",9:"Donald",10:"Sandra",11:"Alexx"};return void 0!==e[t]?e[t]:"no name"}},{key:"loadMore",value:function(t){if(!(this.loadStep<t.length))return!1;for(var e=this.loadStep;e<t.length;e++){if(this.loadStep+5===e)break;this.toStorage(t[e].userId,t[e].title," ",t[e].completed)}this.loadStep+=5,window.localStorage.setItem("loadStep",JSON.stringify(this.loadStep))}}])&&s(e.prototype,n),o&&s(e,o),t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=u(this,f(e).call(this))).model=t,o.view=n,o.view.btnLoadMore.addEventListener("click",function(t){o.actionLoadMore()}),o.view.btnAddNew.addEventListener("click",function(t){o.modalNewTask()}),o.view.btnSave.addEventListener("click",function(t){o.actionSave(t)}),o.view.btnShowAll.addEventListener("click",function(t){o.actionFilter("all")}),o.view.btnShowComleted.addEventListener("click",function(t){o.actionFilter("completed")}),o.view.btnshowNotCompled.addEventListener("click",function(t){o.actionFilter("notCompleted")}),o.view.btnOrderTasks.addEventListener("click",function(t){o.actionOrderDirection()}),n.on("completed",function(t){return o.actionComplited(t)}),n.on("delete",function(t){return o.actionDelete(t)}),n.on("show",function(t){return o.actionShowTask(t)}),o}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,r),n=e,(o=[{key:"actionComplited",value:function(t){this.model.setComplited(t.getAttribute("data-index")),this.view.rebuildTable()}},{key:"actionDelete",value:function(t){this.model.deleteTask(t.getAttribute("data-index")),this.view.rebuildTable()}},{key:"actionShowTask",value:function(t){var e=this.model.findTaskById(t.getAttribute("data-index"));this.view.btnSave.setAttribute("action","update"),document.getElementById("myModal").setAttribute("data-index",e.data.id),document.getElementById("modal-title").textContent="TaskID: "+e.data.id,document.getElementById("title-todo").value=e.data.title,document.getElementById("textToDo").value=e.data.fullText,a()("#myModal").modal("show")}},{key:"actionLoadMore",value:function(){var t=this;fetch("https://jsonplaceholder.typicode.com/todos").then(function(t){return t.json()}).then(function(e){t.model.loadMore(e),t.view.rebuildTable()}).catch(function(){console.log("error")})}},{key:"actionFilter",value:function(t){this.model.filterTask(t),this.view.rebuildTable()}},{key:"actionOrderDirection",value:function(){this.model.OrderDirection(),this.view.rebuildTable()}},{key:"modalNewTask",value:function(){document.getElementById("myModal").setAttribute("data-index",""),document.getElementById("modal-title").textContent="ADD new task",document.getElementById("title-todo").value="",document.getElementById("textToDo").value="",this.view.btnSave.setAttribute("action","saveNew"),a()("#myModal").modal("show")}},{key:"actionSave",value:function(t){var e=document.getElementById("title-todo"),n=document.getElementById("textToDo");if("saveNew"===t.currentTarget.getAttribute("action")&&this.model.toStorage(this.model.activeUser,e.value,n.value),"update"===t.currentTarget.getAttribute("action")){var o=document.getElementById("myModal").getAttribute("data-index");this.model.updateTask(o,e.value,n.value)}document.getElementById("myModal").setAttribute("data-index",""),e.value="",n.value="",a()("#myModal").modal("hide"),this.view.rebuildTable()}},{key:"setView",value:function(){0===this.model.taskList.length?this.view.showMsg("no tasks yet"):this.view.showTaskList(this.model.taskList,3)}}])&&c(n.prototype,o),i&&c(n,i),e}();function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var k=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=v(this,y(e).call(this))).model=t,o.wraper=n.wraper,o.btnAddNew=n.btnAddNew,o.btnSave=n.btnSave,o.btnLoadMore=n.btnLoadMore,o.btnShowAll=n.btnShowAll,o.btnShowComleted=n.btnShowComleted,o.btnshowNotCompled=n.btnshowNotCompled,o.btnOrderTasks=n.btnOrderTasks,o}var n,o,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(e,r),n=e,(o=[{key:"rebuildTable",value:function(){if(this.wraper.innerHTML=" ",this.filterBtnClassToggle(),this.orderDirectionToggle(),0===this.model.taskList.length)this.showMsg("no tasks yet");else{var t=document.querySelector(".text-msg");t&&t.remove(),this.showTaskList()}}},{key:"showTaskList",value:function(){var t=this.model.taskList.slice();"up"===this.model.oderTask&&t.reverse();for(var e=0;e<t.length;e++)switch(this.model.taskFilter){case"completed":t[e].completed&&this.createTableRow(t[e]);break;case"notCompleted":t[e].completed||this.createTableRow(t[e]);break;case"all":this.createTableRow(t[e])}}},{key:"filterBtnClassToggle",value:function(){switch(this.btnShowAll.classList.remove("active"),this.btnShowComleted.classList.remove("active"),this.btnshowNotCompled.classList.remove("active"),this.model.taskFilter){case"completed":this.btnShowComleted.classList.add("active");break;case"notCompleted":this.btnshowNotCompled.classList.add("active");break;case"all":this.btnShowAll.classList.add("active")}}},{key:"orderDirectionToggle",value:function(){"down"===this.model.oderTask?(this.btnOrderTasks.innerHTML='<i class="fas fa-sort-amount-down"></i>',this.btnOrderTasks.setAttribute("data-title","Old to new")):(this.btnOrderTasks.innerHTML='<i class="fas  fa-sort-amount-up"></i>',this.btnOrderTasks.setAttribute("data-title","New to old"))}},{key:"createTableRow",value:function(t){var e=document.createElement("tr");t.completed&&e.classList.add("table-success");var n=document.createElement("td");n.innerHTML=t.id,n.classList.add("task-id"),e.appendChild(n);var o=document.createElement("td");o.classList.add("task-autor"),o.innerHTML=this.model.getAutor(t.userId),e.appendChild(o);var a=document.createElement("td");a.innerHTML=t.title,a.classList.add("task-title"),e.appendChild(a);var i=document.createElement("td");i.classList.add("task-title"),this.createActionBar(i,t.id,t.completed),e.appendChild(i),this.wraper.appendChild(e)}},{key:"showMsg",value:function(t){var e=document.createElement("div");e.classList.add("text-msg"),e.textContent=t,document.querySelector("body").prepend(e)}},{key:"createActionBar",value:function(t,e,n){var o=this,a=0,i=document.createElement("button");switch(i.classList.add("btn"),i.classList.add("btn-outline-success"),i.setAttribute("data-index",e),n){case!0:a='<i class="fas fa-check-square"></i>',i.setAttribute("data-title","Set uncomplete");break;default:i.setAttribute("data-title","Set complete"),a='<i class="far fa-square"></i>'}i.innerHTML=a,i.addEventListener("click",function(t){return o.emit("completed",t.currentTarget)}),t.appendChild(i);var r=document.createElement("button");r.classList.add("btn"),r.classList.add("btn-outline-primary"),r.setAttribute("data-index",e),r.setAttribute("data-title","Edit task"),r.innerHTML='<i class="fas fa-edit fa-sm"></i>',r.addEventListener("click",function(t){return o.emit("show",t.currentTarget)}),t.appendChild(r);var s=document.createElement("button");s.classList.add("btn"),s.classList.add("btn-outline-danger"),s.setAttribute("data-index",e),s.setAttribute("data-title","Delete task"),s.innerHTML='<i class="fas fa-trash-alt"></i>',s.addEventListener("click",function(t){return o.emit("delete",t.currentTarget)}),t.appendChild(s)}}])&&p(n.prototype,o),a&&p(n,a),e}(),g=new l,S=new k(g,{wraper:document.getElementById("task-list"),btnAddNew:document.getElementById("createNew"),btnSave:document.getElementById("save"),btnLoadMore:document.getElementById("load-more"),btnShowAll:document.getElementById("showAll"),btnShowComleted:document.getElementById("showComleted"),btnshowNotCompled:document.getElementById("showNotCompled"),btnOrderTasks:document.getElementById("tasks-order")});new h(g,S);S.rebuildTable()}]);